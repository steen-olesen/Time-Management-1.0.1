import{r as e,j as t,u as s,a,R as r,F as i,b as n,c as l,d,e as c,f as o,L as m,g as x,h,i as u,k as g,l as p,O as y,m as b,n as j,o as f,p as N,q as k,s as v,t as w,v as C,w as _,x as M,y as S,z as F,A as D,B as T,C as E,D as A,E as B,G as $,H as P,I as H,J as q,K as I,M as R,N as L,P as O,X as U,Y as W,T as z,Q as Y,S as J,U as K,V,W as G,Z as Q,_ as X,$ as Z,a0 as ee}from"./react-vendor-Cwo1Qmds.js";import{c as te}from"./supabase-hR2CbOxA.js";import{f as se,l as ae,s as re,e as ie,a as ne,b as le,c as de,d as ce,p as oe,i as me,g as xe,h as he,j as ue}from"./date-BYKyYjoV.js";import{E as ge}from"./pdf--7DInoVY.js";import"./vendor-DeEgWeTl.js";import"./charts-C2iGx6s9.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const pe=te("https://avsqfibhfxrudoiwyafy.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF2c3FmaWJoZnhydWRvaXd5YWZ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk3MzY3NDksImV4cCI6MjA2NTMxMjc0OX0.xelorgdtnDJadgY9vzshg2na3jkSIJlx5xnI6FRVKps"),ye=e.createContext(void 0);function be({children:s}){const[a,r]=e.useState(null),[i,n]=e.useState(null),[l,d]=e.useState(!0);e.useEffect(()=>{pe.auth.getSession().then(({data:{session:e}})=>{n(e),r(e?.user??null),d(!1)});const{data:{subscription:e}}=pe.auth.onAuthStateChange((e,t)=>{n(t),r(t?.user??null),d(!1)});return()=>{e.unsubscribe()}},[]);const c={user:a,session:i,loading:l,signIn:async(e,t)=>{try{const{error:s}=await pe.auth.signInWithPassword({email:e,password:t});return{error:s}}catch(s){return{error:s}}},signOut:async()=>{await pe.auth.signOut()}};return t.jsx(ye.Provider,{value:c,children:s})}function je(){const t=e.useContext(ye);if(void 0===t)throw new Error("useAuth must be used within an AuthProvider");return t}function fe(){const{user:e,signOut:b}=je(),j=s(),f=a(),[N,k]=r.useState(!1),[v,w]=r.useState(()=>"undefined"!=typeof window&&("true"===localStorage.getItem("darkMode")||window.matchMedia("(prefers-color-scheme: dark)").matches));r.useEffect(()=>{v?(document.documentElement.classList.add("dark"),localStorage.setItem("darkMode","true")):(document.documentElement.classList.remove("dark"),localStorage.setItem("darkMode","false"))},[v]);const C=()=>{w(!v)},_=async()=>{await b(),f("/login")},M=[{name:"Dashboard",href:"/",icon:i},{name:"Customers",href:"/customers",icon:n},{name:"Projects",href:"/projects",icon:l},{name:"Tasks",href:"/tasks",icon:d},{name:"Time Entries",href:"/time-entries",icon:c},{name:"Reports",href:"/reports",icon:o}],S=e=>j.pathname===e;return t.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 flex",children:[t.jsxs("div",{className:"hidden md:flex md:flex-col md:w-64 md:fixed md:inset-y-0 bg-white dark:bg-gray-800 shadow-md",children:[t.jsxs("div",{className:"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto",children:[t.jsx("div",{className:"flex items-center justify-center flex-shrink-0 px-4 mb-5",children:t.jsx("h1",{className:"text-xl font-bold text-primary-600",children:"TimeTracker"})}),t.jsx("nav",{className:"mt-5 flex-1 px-2 space-y-1",children:M.map(e=>t.jsxs(m,{to:e.href,className:"group flex items-center px-4 py-3 text-sm font-medium rounded-md "+(S(e.href)?"bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"),children:[t.jsx(e.icon,{className:"mr-3 h-5 w-5 "+(S(e.href)?"text-primary-500 dark:text-primary-400":"text-gray-500 dark:text-gray-400 group-hover:text-gray-600 dark:group-hover:text-gray-300")}),e.name]},e.name))})]}),t.jsx("div",{className:"flex-shrink-0 flex border-t border-gray-200 dark:border-gray-700 p-4",children:t.jsx("div",{className:"flex-shrink-0 w-full group block",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{children:t.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e?.email})}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:C,className:"p-1 rounded-full text-gray-500 dark:text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",children:v?t.jsx(x,{className:"h-5 w-5"}):t.jsx(h,{className:"h-5 w-5"})}),t.jsx("button",{onClick:_,className:"p-1 rounded-full text-gray-500 dark:text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",children:t.jsx(u,{className:"h-5 w-5"})})]})]})})})]}),t.jsxs("div",{className:"md:hidden fixed top-0 inset-x-0 z-10 bg-white dark:bg-gray-800 shadow-md",children:[t.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[t.jsx("h1",{className:"text-xl font-bold text-primary-600",children:"TimeTracker"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:C,className:"p-1 rounded-full text-gray-500 dark:text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",children:v?t.jsx(x,{className:"h-5 w-5"}):t.jsx(h,{className:"h-5 w-5"})}),t.jsx("button",{onClick:()=>k(!N),className:"p-1 rounded-full text-gray-500 dark:text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",children:N?t.jsx(g,{className:"h-6 w-6"}):t.jsx(p,{className:"h-6 w-6"})})]})]}),N&&t.jsxs("nav",{className:"px-2 pt-2 pb-3 space-y-1 bg-white dark:bg-gray-800 shadow-lg",children:[M.map(e=>t.jsxs(m,{to:e.href,className:"group flex items-center px-3 py-2 text-base font-medium rounded-md "+(S(e.href)?"bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"),onClick:()=>k(!1),children:[t.jsx(e.icon,{className:"mr-3 h-5 w-5 "+(S(e.href)?"text-primary-500 dark:text-primary-400":"text-gray-500 dark:text-gray-400 group-hover:text-gray-600 dark:group-hover:text-gray-300")}),e.name]},e.name)),t.jsxs("button",{onClick:_,className:"w-full group flex items-center px-3 py-2 text-base font-medium rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:[t.jsx(u,{className:"mr-3 h-5 w-5 text-gray-500 dark:text-gray-400 group-hover:text-gray-600 dark:group-hover:text-gray-300"}),"Sign Out"]})]})]}),t.jsx("div",{className:"md:pl-64 flex flex-col flex-1",children:t.jsx("main",{className:"flex-1",children:t.jsx("div",{className:"py-6 px-4 sm:px-6 md:px-8 mt-14 md:mt-0",children:t.jsx(y,{})})})})]})}const Ne=ae,ke=e=>re(e,{weekStartsOn:1}),ve=e=>ie(e,{weekStartsOn:1}),we=e=>new Intl.NumberFormat("da-DK",{style:"currency",currency:"DKK",minimumFractionDigits:0,maximumFractionDigits:2}).format(e),Ce=(e,t)=>se(e,t||"dd/MM-yyyy",{locale:Ne}),_e=e=>se(e,"MMM yyyy",{locale:Ne});function Me(){const{user:s}=je(),[a,r]=e.useState({customers:0,projects:0,tasks:0,timeEntries:0}),[i,l]=e.useState([]),[o,x]=e.useState(!0),[h,u]=e.useState(null);e.useEffect(()=>{if(!s)return;(async()=>{try{x(!0);const[{count:e},{count:a},{count:i},{count:n}]=await Promise.all([pe.from("customers").select("id",{count:"exact",head:!0}).eq("user_id",s.id),pe.from("projects").select("id",{count:"exact",head:!0}).eq("user_id",s.id),pe.from("tasks").select("id",{count:"exact",head:!0}).eq("user_id",s.id),pe.from("time_entries").select("id",{count:"exact",head:!0}).eq("user_id",s.id)]);r({customers:e||0,projects:a||0,tasks:i||0,timeEntries:n||0});const{data:d,error:o}=await pe.from("time_entries").select("*").eq("user_id",s.id);if(o)return void console.error("Error fetching time entries:",o);const m=new Date,h=ne(m),g=ke(m),p=ve(m),y=le(m),b=de(m),j=le(ce(m,1)),N=de(ce(m,1));u({entriesCount:d?.length||0,sampleEntries:d?.slice(0,3)||[],weekBoundaries:{thisWeekStart:g.toISOString(),thisWeekEnd:p.toISOString(),today:h.toISOString()}});const k=e=>{try{return e.date?oe(e.date):e.start_time?oe(e.start_time):e.created_at?oe(e.created_at):null}catch(t){return console.error("Error parsing date:",t),null}},v=(e,t,s)=>!!e&&(s?(me(e,t)||xe(e,t))&&(he(e,s)||xe(e,s)):me(e,t)||xe(e,t)),w=d?.filter(e=>{const t=k(e);return v(t,h)})||[],C=d?.filter(e=>{const t=k(e);return v(t,g,p)})||[],_=d?.filter(e=>{const t=k(e);return v(t,y,b)})||[],M=d?.filter(e=>{const t=k(e);return v(t,j,N)})||[],S=e=>{if(!e||0===e.length)return 0;let t=0;for(const a of e){if(null!==a.duration_minutes&&void 0!==a.duration_minutes){const e=parseFloat(String(a.duration_minutes));if(!isNaN(e)){t+=e;continue}}if(null!==a.duration&&void 0!==a.duration){const e=parseFloat(String(a.duration));if(!isNaN(e)){t+=e;continue}}if(a.start_time&&a.end_time)try{const e=oe(a.start_time),s=oe(a.end_time).getTime()-e.getTime(),r=Math.floor(s/6e4);r>0&&(t+=r)}catch(s){console.error("Error calculating duration from timestamps:",s)}}return Math.round(t/60*10)/10};l([{period:"Today",hours:S(w),icon:t.jsx(c,{}),color:"bg-blue-500",dateRange:se(m,"MMM d")},{period:"This Week",hours:S(C),icon:t.jsx(c,{}),color:"bg-green-500",dateRange:`${se(g,"MMM d")} - ${se(p,"MMM d")}`},{period:"This Month",hours:S(_),icon:t.jsx(f,{}),color:"bg-purple-500",dateRange:se(m,"MMMM yyyy")},{period:"Last Month",hours:S(M),icon:t.jsx(f,{}),color:"bg-orange-500",dateRange:se(ce(m,1),"MMMM yyyy")}])}catch(e){console.error("Error fetching dashboard data:",e)}finally{x(!1)}})()},[s]);const g=[{title:"Customers",count:a.customers,icon:t.jsx(n,{}),color:"bg-blue-500",link:"/customers"},{title:"Projects",count:a.projects,icon:t.jsx(b,{}),color:"bg-green-500",link:"/projects"},{title:"Tasks",count:a.tasks,icon:t.jsx(d,{}),color:"bg-purple-500",link:"/tasks"},{title:"Time Entries",count:a.timeEntries,icon:t.jsx(c,{}),color:"bg-orange-500",link:"/time-entries"}];return o?t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Dashboard"}),t.jsx(m,{to:"/time-entries",className:"btn btn-primary w-full sm:w-auto text-center",children:"View All Time Entries"})]}),t.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:g.map(e=>t.jsx(m,{to:e.link,className:"card hover:shadow-lg transition-shadow p-3 md:p-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:`p-2 md:p-3 rounded-full ${e.color} text-white mr-2 md:mr-4 flex-shrink-0`,children:e.icon}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"text-xs md:text-sm text-gray-500 dark:text-gray-400 truncate",children:e.title}),t.jsx("p",{className:"text-lg md:text-2xl font-semibold text-gray-900 dark:text-white",children:e.count})]})]})},e.title))}),t.jsxs("div",{className:"card p-4",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Time Highlights"}),t.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:i.map(e=>t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 md:p-4 shadow",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:`p-2 md:p-3 rounded-full ${e.color} text-white mr-2 md:mr-4 flex-shrink-0`,children:e.icon}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"text-xs md:text-sm text-gray-500 dark:text-gray-400 truncate",children:e.period}),t.jsxs("p",{className:"text-lg md:text-2xl font-semibold text-gray-900 dark:text-white",children:[e.hours," hrs"]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:e.dateRange})]})]})},e.period))})]}),!1,t.jsxs("div",{className:"card p-4",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Quick Actions"}),t.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[t.jsxs(m,{to:"/customers",className:"btn btn-secondary w-full flex items-center justify-center py-3",children:[t.jsx(n,{className:"mr-2"})," ",t.jsx("span",{className:"truncate",children:"Add Customer"})]}),t.jsxs(m,{to:"/projects",className:"btn btn-secondary w-full flex items-center justify-center py-3",children:[t.jsx(b,{className:"mr-2"})," ",t.jsx("span",{className:"truncate",children:"Add Project"})]}),t.jsxs(m,{to:"/tasks",className:"btn btn-secondary w-full flex items-center justify-center py-3",children:[t.jsx(d,{className:"mr-2"})," ",t.jsx("span",{className:"truncate",children:"Add Task"})]}),t.jsxs(m,{to:"/reports",className:"btn btn-secondary w-full flex items-center justify-center py-3",children:[t.jsx(j,{className:"mr-2"})," ",t.jsx("span",{className:"truncate",children:"View Reports"})]})]})]})]})}function Se(){const[s,r]=e.useState(""),[i,n]=e.useState(""),[l,d]=e.useState(null),[c,o]=e.useState(!1),m=a(),{signIn:x}=je();return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:t.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white dark:bg-gray-800 p-8 rounded-lg shadow-md",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:"TimeTracker"}),t.jsx("h2",{className:"mt-6 text-center text-2xl font-bold text-gray-900 dark:text-white",children:"Sign in to your account"})]}),l&&t.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-3 rounded-md text-sm",children:l}),t.jsxs("form",{className:"mt-8 space-y-6",onSubmit:async e=>{if(e.preventDefault(),s&&i)try{d(null),o(!0);const{error:e}=await x(s,i);if(e)throw e;m("/")}catch(t){console.error("Login error:",t),d(t.message||"Failed to sign in")}finally{o(!1)}else d("Please enter both email and password")},children:[t.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email address"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx(N,{className:"h-5 w-5 text-gray-400"})}),t.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:s,onChange:e=>r(e.target.value),className:"appearance-none relative block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white dark:bg-gray-700 rounded-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Email address"})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Password"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx(k,{className:"h-5 w-5 text-gray-400"})}),t.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:i,onChange:e=>n(e.target.value),className:"appearance-none relative block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white dark:bg-gray-700 rounded-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Password"})]})]})]}),t.jsx("div",{children:t.jsxs("button",{type:"submit",disabled:c,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:t.jsx(v,{className:"h-5 w-5 text-primary-500 group-hover:text-primary-400"})}),c?"Signing in...":"Sign in"]})})]})]})})}function Fe(){const{user:s}=je(),[a,r]=e.useState([]),[i,n]=e.useState(!0),[l,d]=e.useState(!1),[c,o]=e.useState(!1),[m,x]=e.useState(null),[h,u]=e.useState({name:"",email:"",phone:"",address:"",contact_person:"",is_active:!0}),[p,y]=e.useState(""),[b,j]=e.useState(null),[f,k]=e.useState(null);e.useEffect(()=>{s&&v()},[s]);const v=async()=>{try{n(!0);const{data:e,error:t}=await pe.from("customers").select("*").eq("user_id",s?.id).order("name");if(t)throw t;r(e||[])}catch(e){console.error("Error fetching customers:",e.message)}finally{n(!1)}},E=(e=null)=>{x(e),u(e?{name:e.name,email:e.email||"",phone:e.phone||"",address:e.address||"",contact_person:e.contact_person||"",is_active:!1!==e.is_active}:{name:"",email:"",phone:"",address:"",contact_person:"",is_active:!0}),d(!0)},A=()=>{d(!1),j(null)},B=e=>{x(e),o(!0)},$=()=>{o(!1)},P=e=>{const{name:t,value:s}=e.target;u(e=>({...e,[t]:s}))},H=a.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())||e.email?.toLowerCase().includes(p.toLowerCase())||e.phone?.toLowerCase().includes(p.toLowerCase()));return t.jsxs("div",{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4 sm:mb-0",children:"Customers"}),t.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",placeholder:"Search customers...",className:"input pl-10",value:p,onChange:e=>y(e.target.value)}),t.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),p&&t.jsx("button",{onClick:()=>y(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:t.jsx(g,{})})]}),t.jsxs("button",{onClick:()=>E(),className:"btn btn-primary flex items-center justify-center",children:[t.jsx(C,{className:"mr-2"})," Add Customer"]})]})]}),i?t.jsx("div",{className:"flex justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):H.length>0?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"hidden sm:block bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Name"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Contact Person"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Email"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Phone"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Address"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:H.map(e=>t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.name}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:e.contact_person||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:e.email||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:e.phone||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(!1!==e.is_active?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"),children:!1!==e.is_active?"Active":"Inactive"})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-300 max-w-xs truncate",children:e.address||"-"}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>E(e),className:"text-primary-600 hover:text-primary-900 dark:hover:text-primary-400 mr-3",children:t.jsx(_,{className:"inline"})}),t.jsx("button",{onClick:()=>B(e),className:"text-red-600 hover:text-red-900 dark:hover:text-red-400",children:t.jsx(M,{className:"inline"})})]})]},e.id))})]})})}),t.jsx("div",{className:"sm:hidden space-y-4",children:H.map(e=>t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-hidden",children:[t.jsx("div",{className:"p-4 cursor-pointer",onClick:()=>{return t=e.id,void k(f===t?null:t);var t},children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),e.contact_person&&t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 flex items-center",children:[t.jsx(S,{className:"mr-1",size:14}),e.contact_person]})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"mr-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(!1!==e.is_active?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"),children:!1!==e.is_active?"Active":"Inactive"}),t.jsx(F,{className:"transition-transform "+(f===e.id?"transform rotate-90":"")})]})]})}),f===e.id&&t.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-gray-100 dark:border-gray-700",children:[t.jsxs("div",{className:"space-y-2",children:[e.email&&t.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[t.jsx(N,{className:"mr-2 flex-shrink-0"}),t.jsx("span",{className:"truncate",children:e.email})]}),e.phone&&t.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[t.jsx(D,{className:"mr-2 flex-shrink-0"}),t.jsx("span",{children:e.phone})]}),e.address&&t.jsxs("div",{className:"flex items-start text-sm text-gray-500 dark:text-gray-400",children:[t.jsx(T,{className:"mr-2 mt-0.5 flex-shrink-0"}),t.jsx("span",{children:e.address})]})]}),t.jsxs("div",{className:"flex justify-end space-x-2 mt-4 pt-3 border-t border-gray-100 dark:border-gray-700",children:[t.jsxs("button",{onClick:t=>{t.stopPropagation(),E(e)},className:"btn btn-sm btn-secondary flex items-center","aria-label":"Edit customer",children:[t.jsx(_,{className:"mr-1"})," Edit"]}),t.jsxs("button",{onClick:t=>{t.stopPropagation(),B(e)},className:"btn btn-sm btn-danger flex items-center","aria-label":"Delete customer",children:[t.jsx(M,{className:"mr-1"})," Delete"]})]})]})]},e.id))})]}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6 text-center",children:[t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:p?"No customers match your search.":"No customers found. Add your first customer to get started."}),p?t.jsx("button",{onClick:()=>y(""),className:"btn btn-secondary",children:"Clear Search"}):t.jsxs("button",{onClick:()=>E(),className:"btn btn-primary flex items-center justify-center mx-auto",children:[t.jsx(C,{className:"mr-2"})," Add Customer"]})]}),l&&t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[t.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:A,children:t.jsx("div",{className:"absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"})}),t.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"​"}),t.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:m?"Edit Customer":"Add Customer"}),b&&t.jsx("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-3 rounded-md text-sm",children:b}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),h.name.trim())try{if(j(null),m){const{error:e}=await pe.from("customers").update({name:h.name,email:h.email,phone:h.phone,address:h.address,contact_person:h.contact_person,is_active:h.is_active}).eq("id",m.id);if(e)throw e}else{const{error:e}=await pe.from("customers").insert([{user_id:s?.id,name:h.name,email:h.email,phone:h.phone,address:h.address,contact_person:h.contact_person,is_active:h.is_active}]);if(e)throw e}A(),v()}catch(t){j(t.message)}else j("Customer name is required")},children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{htmlFor:"name",className:"label",children:["Name ",t.jsx("span",{className:"text-red-600",children:"*"})]}),t.jsx("input",{type:"text",id:"name",name:"name",value:h.name,onChange:P,className:"input",required:!0})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"contact_person",className:"label",children:"Contact Person"}),t.jsx("input",{type:"text",id:"contact_person",name:"contact_person",value:h.contact_person,onChange:P,className:"input"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"email",className:"label",children:"Email"}),t.jsx("input",{type:"email",id:"email",name:"email",value:h.email,onChange:P,className:"input"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"phone",className:"label",children:"Phone"}),t.jsx("input",{type:"text",id:"phone",name:"phone",value:h.phone,onChange:P,className:"input"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"address",className:"label",children:"Address"}),t.jsx("textarea",{id:"address",name:"address",value:h.address,onChange:P,className:"input",rows:3})]}),t.jsxs("div",{className:"mb-4 flex items-center",children:[t.jsx("input",{type:"checkbox",id:"is_active",name:"is_active",checked:h.is_active,onChange:e=>{const{name:t,checked:s}=e.target;u(e=>({...e,[t]:s}))},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),t.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900 dark:text-gray-300",children:"Active"})]}),t.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[t.jsx("button",{type:"button",onClick:A,className:"btn btn-secondary",children:"Cancel"}),t.jsx("button",{type:"submit",className:"btn btn-primary",children:m?"Update":"Create"})]})]})]})})]})}),c&&t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[t.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:$,children:t.jsx("div",{className:"absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"})}),t.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"​"}),t.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Delete Customer"}),b&&t.jsx("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-3 rounded-md text-sm",children:b}),t.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Are you sure you want to delete ",t.jsx("span",{className:"font-semibold",children:m?.name}),"? This action cannot be undone."]}),t.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[t.jsx("button",{type:"button",onClick:$,className:"btn btn-secondary",children:"Cancel"}),t.jsx("button",{type:"button",onClick:async()=>{if(m)try{const{count:e,error:t}=await pe.from("projects").select("id",{count:"exact",head:!0}).eq("customer_id",m.id);if(t)throw t;if(e&&e>0)return void j(`Cannot delete customer. There are ${e} projects associated with this customer.`);const{error:s}=await pe.from("customers").delete().eq("id",m.id);if(s)throw s;$(),v()}catch(e){j(e.message)}},className:"btn btn-danger",children:"Delete"})]})]})})]})})]})}function De(){const{user:s}=je(),[a,r]=e.useState([]),[i,n]=e.useState([]),[l,d]=e.useState(!0),[c,o]=e.useState(!1),[m,x]=e.useState(!1),[h,u]=e.useState(null),[p,y]=e.useState({name:"",description:"",status:"active",customer_id:"",start_date:"",end_date:"",budget:""}),[b,j]=e.useState(""),[N,k]=e.useState(null),[v,S]=e.useState(null);e.useEffect(()=>{s&&(D(),T())},[s]);const D=async()=>{try{d(!0);const{data:e,error:t}=await pe.from("projects").select("\n          *,\n          customer:customers(id, name)\n        ").eq("user_id",s?.id).order("name");if(t)throw t;r(e||[])}catch(e){console.error("Error fetching projects:",e.message)}finally{d(!1)}},T=async()=>{try{const{data:e,error:t}=await pe.from("customers").select("id, name").eq("user_id",s?.id).order("name");if(t)throw t;n(e||[])}catch(e){console.error("Error fetching customers:",e.message)}},B=(e=null)=>{u(e),y(e?{name:e.name,description:e.description||"",status:e.status||"active",customer_id:e.customer_id,start_date:e.start_date||"",end_date:e.end_date||"",budget:e.budget?String(e.budget):""}:{name:"",description:"",status:"active",customer_id:i.length>0?i[0].id:"",start_date:"",end_date:"",budget:""}),o(!0)},$=()=>{o(!1),k(null)},P=e=>{u(e),x(!0)},H=()=>{x(!1),k(null)},q=e=>{const{name:t,value:s}=e.target;y(e=>({...e,[t]:s}))},I=a.filter(e=>e.name.toLowerCase().includes(b.toLowerCase())||e.description?.toLowerCase().includes(b.toLowerCase())||e.customer?.name.toLowerCase().includes(b.toLowerCase())),R=e=>{switch(e){case"active":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"completed":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400";case"on-hold":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400";case"cancelled":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},L=e=>e.charAt(0).toUpperCase()+e.slice(1).replace("-"," ");return t.jsxs("div",{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4 sm:mb-0",children:"Projects"}),t.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",placeholder:"Search projects...",className:"input pl-10",value:b,onChange:e=>j(e.target.value)}),t.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),b&&t.jsx("button",{onClick:()=>j(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:t.jsx(g,{})})]}),t.jsxs("button",{onClick:()=>B(),className:"btn btn-primary flex items-center justify-center",disabled:0===i.length,children:[t.jsx(C,{className:"mr-2"})," Add Project"]})]})]}),0===i.length&&!l&&t.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-400 p-4 rounded-md mb-6",children:t.jsx("p",{children:"You need to create a customer before you can add projects."})}),l?t.jsx("div",{className:"flex justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):I.length>0?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"hidden sm:block bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Name"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Customer"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Description"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:I.map(e=>t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.name}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:e.customer?.name||"Unknown Customer"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${R(e.status)}`,children:L(e.status)})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-300 max-w-xs truncate",children:e.description||"-"}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>B(e),className:"text-primary-600 hover:text-primary-900 dark:hover:text-primary-400 mr-3",children:t.jsx(_,{className:"inline"})}),t.jsx("button",{onClick:()=>P(e),className:"text-red-600 hover:text-red-900 dark:hover:text-red-400",children:t.jsx(M,{className:"inline"})})]})]},e.id))})]})})}),t.jsx("div",{className:"sm:hidden space-y-4",children:I.map(e=>t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-hidden",children:[t.jsx("div",{className:"p-4 cursor-pointer",onClick:()=>{return t=e.id,void S(v===t?null:t);var t},children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:e.customer?.name||"Unknown Customer"})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:`mr-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${R(e.status)}`,children:L(e.status)}),t.jsx(F,{className:"transition-transform "+(v===e.id?"transform rotate-90":"")})]})]})}),v===e.id&&t.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-gray-100 dark:border-gray-700",children:[t.jsxs("div",{className:"space-y-3",children:[e.description&&t.jsxs("div",{className:"flex items-start text-sm text-gray-500 dark:text-gray-400",children:[t.jsx(E,{className:"mr-2 mt-0.5 flex-shrink-0"}),t.jsx("span",{children:e.description})]}),e.budget&&t.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[t.jsx(A,{className:"mr-2 flex-shrink-0"}),t.jsxs("span",{children:["Budget: ",new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e.budget)]})]}),t.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-500 dark:text-gray-400",children:[e.start_date&&t.jsxs("div",{className:"flex items-center",children:[t.jsx(f,{className:"mr-1 flex-shrink-0"}),t.jsxs("span",{children:["Start: ",se(new Date(e.start_date),"MMM d, yyyy")]})]}),e.end_date&&t.jsxs("div",{className:"flex items-center",children:[t.jsx(f,{className:"mr-1 flex-shrink-0"}),t.jsxs("span",{children:["End: ",se(new Date(e.end_date),"MMM d, yyyy")]})]})]})]}),t.jsxs("div",{className:"flex justify-end space-x-2 mt-4 pt-3 border-t border-gray-100 dark:border-gray-700",children:[t.jsxs("button",{onClick:t=>{t.stopPropagation(),B(e)},className:"btn btn-sm btn-secondary flex items-center","aria-label":"Edit project",children:[t.jsx(_,{className:"mr-1"})," Edit"]}),t.jsxs("button",{onClick:t=>{t.stopPropagation(),P(e)},className:"btn btn-sm btn-danger flex items-center","aria-label":"Delete project",children:[t.jsx(M,{className:"mr-1"})," Delete"]})]})]})]},e.id))})]}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6 text-center",children:[t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:b?"No projects match your search.":"No projects found. Add your first project to get started."}),b?t.jsx("button",{onClick:()=>j(""),className:"btn btn-secondary",children:"Clear Search"}):i.length>0?t.jsxs("button",{onClick:()=>B(),className:"btn btn-primary flex items-center justify-center mx-auto",children:[t.jsx(C,{className:"mr-2"})," Add Project"]}):t.jsxs("button",{onClick:()=>window.location.href="/customers",className:"btn btn-primary flex items-center justify-center mx-auto",children:[t.jsx(C,{className:"mr-2"})," Add Customer First"]})]}),c&&t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[t.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:$,children:t.jsx("div",{className:"absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"})}),t.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"​"}),t.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:h?"Edit Project":"Add Project"}),N&&t.jsx("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-3 rounded-md text-sm",children:N}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),p.name.trim())if(p.customer_id)try{if(k(null),h){const{error:e}=await pe.from("projects").update({name:p.name,description:p.description,status:p.status,customer_id:p.customer_id,start_date:p.start_date||null,end_date:p.end_date||null,budget:p.budget?parseFloat(p.budget):null}).eq("id",h.id);if(e)throw e}else{const{error:e}=await pe.from("projects").insert([{user_id:s?.id,name:p.name,description:p.description,status:p.status,customer_id:p.customer_id,start_date:p.start_date||null,end_date:p.end_date||null,budget:p.budget?parseFloat(p.budget):null}]);if(e)throw e}$(),D()}catch(t){k(t.message)}else k("Please select a customer");else k("Project name is required")},children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{htmlFor:"customer_id",className:"label",children:["Customer ",t.jsx("span",{className:"text-red-600",children:"*"})]}),t.jsxs("select",{id:"customer_id",name:"customer_id",value:p.customer_id,onChange:q,className:"input",required:!0,children:[t.jsx("option",{value:"",children:"Select a customer"}),i.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{htmlFor:"name",className:"label",children:["Project Name ",t.jsx("span",{className:"text-red-600",children:"*"})]}),t.jsx("input",{type:"text",id:"name",name:"name",value:p.name,onChange:q,className:"input",required:!0})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"status",className:"label",children:"Status"}),t.jsxs("select",{id:"status",name:"status",value:p.status,onChange:q,className:"input",children:[t.jsx("option",{value:"active",children:"Active"}),t.jsx("option",{value:"completed",children:"Completed"}),t.jsx("option",{value:"on-hold",children:"On Hold"}),t.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"start_date",className:"label",children:"Start Date"}),t.jsx("input",{type:"date",id:"start_date",name:"start_date",value:p.start_date,onChange:q,className:"input"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"end_date",className:"label",children:"End Date"}),t.jsx("input",{type:"date",id:"end_date",name:"end_date",value:p.end_date,onChange:q,className:"input"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"budget",className:"label",children:"Budget"}),t.jsx("input",{type:"number",id:"budget",name:"budget",value:p.budget,onChange:q,className:"input",step:"0.01",min:"0"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"description",className:"label",children:"Description"}),t.jsx("textarea",{id:"description",name:"description",value:p.description,onChange:q,className:"input",rows:3})]}),t.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[t.jsx("button",{type:"button",onClick:$,className:"btn btn-secondary",children:"Cancel"}),t.jsx("button",{type:"submit",className:"btn btn-primary",children:h?"Update":"Create"})]})]})]})})]})}),m&&t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[t.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:H,children:t.jsx("div",{className:"absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"})}),t.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"​"}),t.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Delete Project"}),N&&t.jsx("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-3 rounded-md text-sm",children:N}),t.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Are you sure you want to delete ",t.jsx("span",{className:"font-semibold",children:h?.name}),"? This action cannot be undone."]}),t.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[t.jsx("button",{type:"button",onClick:H,className:"btn btn-secondary",children:"Cancel"}),t.jsx("button",{type:"button",onClick:async()=>{if(h)try{const{count:e,error:t}=await pe.from("tasks").select("id",{count:"exact",head:!0}).eq("project_id",h.id);if(t)throw t;if(e&&e>0)return void k(`Cannot delete project. There are ${e} tasks associated with this project.`);const{error:s}=await pe.from("projects").delete().eq("id",h.id);if(s)throw s;H(),D()}catch(e){k(e.message)}},className:"btn btn-danger",children:"Delete"})]})]})})]})})]})}function Te(){const{user:s}=je(),[a,r]=e.useState([]),[i,n]=e.useState(!0),[l,d]=e.useState(!1),[c,o]=e.useState(!1),[m,x]=e.useState(null),[h,u]=e.useState({name:"",description:""}),[p,y]=e.useState(""),[b,j]=e.useState(null);e.useEffect(()=>{s&&f()},[s]);const f=async()=>{try{n(!0);const{data:e,error:t}=await pe.from("tasks").select("*").eq("user_id",s?.id).order("name");if(t)throw t;r(e||[])}catch(e){console.error("Error fetching tasks:",e.message)}finally{n(!1)}},N=(e=null)=>{x(e),u(e?{name:e.name,description:e.description||""}:{name:"",description:""}),d(!0)},k=()=>{d(!1),j(null)},v=()=>{o(!1),j(null)},S=e=>{const{name:t,value:s}=e.target;u(e=>({...e,[t]:s}))},F=a.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())||e.description?.toLowerCase().includes(p.toLowerCase()));return t.jsxs("div",{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4 sm:mb-0",children:"Tasks"}),t.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",placeholder:"Search tasks...",className:"input pl-10",value:p,onChange:e=>y(e.target.value)}),t.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),p&&t.jsx("button",{onClick:()=>y(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:t.jsx(g,{})})]}),t.jsxs("button",{onClick:()=>N(),className:"btn btn-primary flex items-center justify-center",children:[t.jsx(C,{className:"mr-2"})," Add Task"]})]})]}),i?t.jsx("div",{className:"flex justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):F.length>0?t.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Name"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Description"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:F.map(e=>t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.name}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-300",children:e.description||"-"}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>N(e),className:"text-primary-600 hover:text-primary-900 dark:hover:text-primary-400 mr-3",children:t.jsx(_,{className:"inline"})}),t.jsx("button",{onClick:()=>(e=>{x(e),o(!0)})(e),className:"text-red-600 hover:text-red-900 dark:hover:text-red-400",children:t.jsx(M,{className:"inline"})})]})]},e.id))})]})})}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6 text-center",children:[t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:p?"No tasks match your search.":"No tasks found. Add your first task to get started."}),p?t.jsx("button",{onClick:()=>y(""),className:"btn btn-secondary",children:"Clear Search"}):t.jsxs("button",{onClick:()=>N(),className:"btn btn-primary flex items-center justify-center mx-auto",children:[t.jsx(C,{className:"mr-2"})," Add Task"]})]}),l&&t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[t.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:k,children:t.jsx("div",{className:"absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"})}),t.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"​"}),t.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:m?"Edit Task":"Add Task"}),b&&t.jsx("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-3 rounded-md text-sm",children:b}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),h.name.trim())try{if(j(null),m){const{error:e}=await pe.from("tasks").update({name:h.name,description:h.description}).eq("id",m.id);if(e)throw e}else{const{error:e}=await pe.from("tasks").insert([{user_id:s?.id,name:h.name,description:h.description}]);if(e)throw e}k(),f()}catch(t){j(t.message)}else j("Task name is required")},children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{htmlFor:"name",className:"label",children:["Task Name ",t.jsx("span",{className:"text-red-600",children:"*"})]}),t.jsx("input",{type:"text",id:"name",name:"name",value:h.name,onChange:S,className:"input",required:!0})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"description",className:"label",children:"Description"}),t.jsx("textarea",{id:"description",name:"description",value:h.description,onChange:S,className:"input",rows:3})]}),t.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[t.jsx("button",{type:"button",onClick:k,className:"btn btn-secondary",children:"Cancel"}),t.jsx("button",{type:"submit",className:"btn btn-primary",children:m?"Update":"Create"})]})]})]})})]})}),c&&t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[t.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:v,children:t.jsx("div",{className:"absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"})}),t.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"​"}),t.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Delete Task"}),b&&t.jsx("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-3 rounded-md text-sm",children:b}),t.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Are you sure you want to delete ",t.jsx("span",{className:"font-semibold",children:m?.name}),"? This action cannot be undone."]}),t.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[t.jsx("button",{type:"button",onClick:v,className:"btn btn-secondary",children:"Cancel"}),t.jsx("button",{type:"button",onClick:async()=>{if(m)try{const{count:e,error:t}=await pe.from("time_entries").select("id",{count:"exact",head:!0}).eq("task_id",m.id);if(t)throw t;if(e&&e>0)return void j(`Cannot delete task. There are ${e} time entries associated with this task.`);const{error:s}=await pe.from("tasks").delete().eq("id",m.id);if(s)throw s;v(),f()}catch(e){j(e.message)}},className:"btn btn-danger",children:"Delete"})]})]})})]})})]})}function Ee(){const{user:s}=je(),[a,r]=e.useState([]),[i,n]=e.useState([]),[l,d]=e.useState([]),[o,m]=e.useState([]),[x,h]=e.useState(!0),[u,p]=e.useState(null),[y,b]=e.useState(0),[j,N]=e.useState(!1),[k,v]=e.useState(!1),[S,D]=e.useState(null),[T,E]=e.useState({task_id:"",project_id:"",customer_id:"",date:"",duration_hours:"",duration_minutes:"",description:"",billable:!0,active:!0,rate:""}),[H,q]=e.useState(""),[I,R]=e.useState(null),[L,O]=e.useState({task:"",project:"",customer:"",dateFrom:"",dateTo:"",billable:"",active:""}),[U,W]=e.useState(!1),[z,Y]=e.useState(null),[J,K]=e.useState([{period:"Today",hours:0,icon:t.jsx(c,{}),color:"bg-blue-500",dateRange:Ce(new Date,"dd MMM")},{period:"This Week",hours:0,icon:t.jsx(c,{}),color:"bg-green-500",dateRange:`${Ce(ke(new Date),"dd MMM")} - ${Ce(new Date,"dd MMM")}`},{period:"This Month",hours:0,icon:t.jsx(f,{}),color:"bg-purple-500",dateRange:_e(new Date)},{period:"Last Month",hours:0,icon:t.jsx(f,{}),color:"bg-orange-500",dateRange:_e(ce(new Date,1))}]);e.useEffect(()=>{s&&(V(),Q(),X(),Z())},[s]),e.useEffect(()=>{const e=setInterval(()=>{u&&b(e=>e+1)},1e3);return()=>clearInterval(e)},[u]);const V=async()=>{try{h(!0);const{data:e,error:t}=await pe.from("time_entries").select("\n          *,\n          task:tasks(\n            id,\n            name\n          ),\n          project:projects(\n            id,\n            name,\n            customer_id\n          ),\n          customer:customers(\n            id,\n            name\n          )\n        ").eq("user_id",s?.id).is("end_time",null).not("start_time","is",null).single();if(t&&"PGRST116"!==t.code&&console.error("Error fetching active timer:",t),e){p(e);const t=new Date(e.start_time||""),s=ue(new Date,t);b(s)}else p(null),b(0);let a=pe.from("time_entries").select("\n          *,\n          task:tasks(\n            id,\n            name\n          ),\n          project:projects(\n            id,\n            name,\n            customer_id\n          ),\n          customer:customers(\n            id,\n            name\n          )\n        ").eq("user_id",s?.id).order("created_at",{ascending:!1});const{data:i,error:n}=await a;if(n)throw console.error("Error fetching time entries:",n),n;r(i||[]),G(i||[])}catch(e){console.error("Error fetching time entries:",e.message)}finally{h(!1)}},G=e=>{const s=ne(new Date),a=ke(new Date),r=le(new Date),i=de(new Date),n=le(ce(new Date,1)),l=de(ce(new Date,1)),d=e=>{try{return e.date?oe(e.date):e.start_time?oe(e.start_time):e.created_at?oe(e.created_at):null}catch(t){return console.error("Error parsing date:",t),null}},o=(e,t,s)=>!!e&&(s?(me(e,t)||xe(e,t))&&(he(e,s)||xe(e,s)):me(e,t)||xe(e,t)),m=e.filter(e=>{const t=d(e);return o(t,s)}),x=e.filter(e=>{const t=d(e);return o(t,a)}),h=e.filter(e=>{const t=d(e);return o(t,r,i)}),u=e.filter(e=>{const t=d(e);return o(t,n,l)}),g=e=>{if(!e||0===e.length)return 0;let t=0;for(const a of e){if(null!==a.duration_minutes&&void 0!==a.duration_minutes){const e=parseFloat(String(a.duration_minutes));if(!isNaN(e)){t+=e;continue}}if(a.start_time&&a.end_time)try{const e=oe(a.start_time),s=oe(a.end_time).getTime()-e.getTime(),r=Math.floor(s/6e4);r>0&&(t+=r)}catch(s){console.error("Error calculating duration from timestamps:",s)}}return Math.round(t/60*10)/10};K([{period:"Today",hours:g(m),icon:t.jsx(c,{}),color:"bg-blue-500",dateRange:Ce(new Date,"dd MMM")},{period:"This Week",hours:g(x),icon:t.jsx(c,{}),color:"bg-green-500",dateRange:`${Ce(ke(new Date),"dd MMM")} - ${Ce(new Date,"dd MMM")}`},{period:"This Month",hours:g(h),icon:t.jsx(f,{}),color:"bg-purple-500",dateRange:_e(new Date)},{period:"Last Month",hours:g(u),icon:t.jsx(f,{}),color:"bg-orange-500",dateRange:_e(ce(new Date,1))}])},Q=async()=>{try{const{data:e,error:t}=await pe.from("tasks").select("\n          id,\n          name\n        ").eq("user_id",s?.id).order("name");if(t)throw t;n(e||[])}catch(e){console.error("Error fetching tasks:",e.message)}},X=async()=>{try{const{data:e,error:t}=await pe.from("projects").select("\n          id,\n          name,\n          customer_id\n        ").eq("user_id",s?.id).order("name");if(t)throw t;d(e||[])}catch(e){console.error("Error fetching projects:",e.message)}},Z=async()=>{try{const{data:e,error:t}=await pe.from("customers").select("\n          id,\n          name\n        ").eq("user_id",s?.id).order("name");if(t)throw t;m(e||[])}catch(e){console.error("Error fetching customers:",e.message)}},ee=(e=null)=>{if(D(e),e){const t=e.date||(e.start_time?se(oe(e.start_time),"yyyy-MM-dd"):se(new Date,"yyyy-MM-dd"));let s="",a="";if(null!==e.duration_minutes)s=Math.floor(e.duration_minutes/60).toString(),a=(e.duration_minutes%60).toString();else if(e.start_time&&e.end_time){const t=ue(new Date(e.end_time),new Date(e.start_time)),r=Math.floor(t/60);s=Math.floor(r/60).toString(),a=(r%60).toString()}E({task_id:e.task_id,project_id:e.project_id||"",customer_id:e.customer_id||e.project?.customer_id||"",date:t,duration_hours:s,duration_minutes:a,description:e.description||"",billable:!1!==e.billable,active:!1!==e.active,rate:e.rate?e.rate.toString():""})}else{const e=se(new Date,"yyyy-MM-dd");E({task_id:"",project_id:"",customer_id:"",date:e,duration_hours:"",duration_minutes:"",description:"",billable:!0,active:!0,rate:""})}N(!0)},te=()=>{N(!1),R(null)},ae=e=>{D(e),v(!0)},re=()=>{v(!1),R(null)},ie=()=>{W(!1)},ge=e=>{const{name:t,value:s}=e.target;E(e=>({...e,[t]:s}))},ye=e=>{const{name:t,checked:s}=e.target;E(e=>({...e,[t]:s}))},be=e=>{const{name:t,value:s}=e.target;O(e=>({...e,[t]:s}))},fe=()=>{O({task:"",project:"",customer:"",dateFrom:"",dateTo:"",billable:"",active:""}),ie(),V()},Ne=async()=>{if(u)try{const e=(new Date).toISOString(),t=u.start_time?new Date(u.start_time):new Date,s=ue(new Date(e),t),a=Math.ceil(s/60),{error:r}=await pe.from("time_entries").update({end_time:e,duration_minutes:a,date:se(t,"yyyy-MM-dd")}).eq("id",u.id);if(r)throw r;p(null),b(0),V()}catch(e){console.error("Error stopping timer:",e.message)}},ve=(e,t,s)=>{if(null!==e){return`${Math.floor(e/60)}h ${e%60}m`}if(t&&s){const e=new Date(t),a=new Date(s),r=ue(a,e),i=Math.floor(r/60);return`${Math.floor(i/60)}h ${i%60}m`}return"-"},Me=a.filter(e=>{const t=(e.task?.name||"").toLowerCase().includes(H.toLowerCase())||(e.project?.name||"").toLowerCase().includes(H.toLowerCase())||(e.customer?.name||"").toLowerCase().includes(H.toLowerCase())||(e.description||"").toLowerCase().includes(H.toLowerCase());let s=!0;L.task&&e.task_id!==L.task&&(s=!1),L.project&&e.project_id!==L.project&&(s=!1),L.customer&&e.customer_id!==L.customer&&(s=!1),L.billable&&("yes"!==L.billable||e.billable?"no"===L.billable&&e.billable&&(s=!1):s=!1),L.active&&("yes"!==L.active||e.active?"no"===L.active&&e.active&&(s=!1):s=!1);const a=e.date?new Date(e.date):e.start_time?new Date(e.start_time):null;if(L.dateFrom&&a){const e=new Date(L.dateFrom);e.setHours(0,0,0,0),a<e&&(s=!1)}if(L.dateTo&&a){const e=new Date(L.dateTo);e.setHours(23,59,59,999),a>e&&(s=!1)}return t&&s}),Se=T.customer_id?l.filter(e=>e.customer_id===T.customer_id):l;return t.jsxs("div",{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4 sm:mb-0",children:"Time Entries"}),t.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",placeholder:"Search entries...",className:"input pl-10",value:H,onChange:e=>q(e.target.value)}),t.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),H&&t.jsx("button",{onClick:()=>q(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:t.jsx(g,{})})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsxs("button",{onClick:()=>{W(!0)},className:"btn btn-secondary flex-1 sm:flex-none flex items-center justify-center","aria-label":"Filter entries",children:[t.jsx(B,{className:"mr-2"})," Filter"]}),t.jsxs("button",{onClick:()=>ee(),className:"btn btn-primary flex-1 sm:flex-none flex items-center justify-center","aria-label":"Add new time entry",children:[t.jsx(C,{className:"mr-2"})," New Entry"]})]})]})]}),t.jsxs("div",{className:"card p-4 mb-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Time Highlights"}),t.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:J.map(e=>t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 md:p-4 shadow",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:`p-2 md:p-3 rounded-full ${e.color} text-white mr-2 md:mr-4 flex-shrink-0`,children:e.icon}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"text-xs md:text-sm text-gray-500 dark:text-gray-400 truncate",children:e.period}),t.jsxs("p",{className:"text-lg md:text-2xl font-semibold text-gray-900 dark:text-white",children:[e.hours," hrs"]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:e.dateRange})]})]})},e.period))})]}),u&&t.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4 mb-6",children:t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[t.jsxs("div",{className:"mb-4 md:mb-0",children:[t.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center",children:[t.jsx(c,{className:"mr-2 text-primary-600"})," Active Timer"]}),t.jsxs("div",{className:"mt-2",children:[t.jsx("p",{className:"text-2xl font-bold text-primary-600",children:(e=>{const t=Math.floor(e/3600),s=Math.floor(e%3600/60),a=e%60;return`${t.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`})(y)}),t.jsxs("p",{className:"mt-1 text-gray-600 dark:text-gray-400",children:[u.customer?.name||"No Customer"," / ",u.project?.name||"No Project"," / ",u.task?.name||"Unknown Task"]}),u.description&&t.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-500",children:u.description})]})]}),t.jsx("div",{children:t.jsxs("button",{onClick:Ne,className:"btn btn-primary flex items-center",children:[t.jsx($,{className:"mr-2"})," Stop Timer"]})})]})}),(0===i.length||0===l.length||0===o.length)&&!x&&t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-400 p-4 rounded-md mb-6",children:[t.jsxs("p",{children:[0===i.length&&"You need to create a task before you can track time. ",0===l.length&&"You need to create a project before you can track time. ",0===o.length&&"You need to create a customer before you can track time. ","Each time entry must be associated with a task, project, and customer."]}),t.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[0===i.length&&t.jsxs("button",{onClick:()=>window.location.href="/tasks",className:"btn btn-primary btn-sm flex items-center justify-center",children:[t.jsx(C,{className:"mr-2"})," Create a Task"]}),0===l.length&&t.jsxs("button",{onClick:()=>window.location.href="/projects",className:"btn btn-primary btn-sm flex items-center justify-center",children:[t.jsx(C,{className:"mr-2"})," Create a Project"]}),0===o.length&&t.jsxs("button",{onClick:()=>window.location.href="/customers",className:"btn btn-primary btn-sm flex items-center justify-center",children:[t.jsx(C,{className:"mr-2"})," Create a Customer"]})]})]}),x?t.jsx("div",{className:"flex justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):Me.length>0?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"hidden sm:block bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Customer / Project / Task"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Duration"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Rate"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Description"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:Me.map(e=>t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[t.jsxs("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:[t.jsx("div",{children:t.jsx("span",{className:"font-medium",children:e.customer?.name||"Unknown Customer"})}),t.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.project?.name||"Unknown Project"," / ",e.task?.name||"Unknown Task"]})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:e.date?Ce(new Date(e.date)):e.start_time?Ce(new Date(e.start_time)):"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:ve(e.duration_minutes,e.start_time,e.end_time)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:e.rate?we(e.rate)+"/hr":"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t.jsxs("div",{className:"flex flex-col space-y-1",children:[t.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(e.billable?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"),children:[t.jsx(A,{className:"mr-1 "+(e.billable?"opacity-100":"opacity-50")}),e.billable?"Billable":"Non-billable"]}),t.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(e.active?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"),children:[t.jsx(P,{className:"mr-1 "+(e.active?"opacity-100":"opacity-50")}),e.active?"Active":"Inactive"]})]})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-300 max-w-xs truncate",children:e.description||"-"}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[!e.end_time&&e.start_time?t.jsx("button",{onClick:Ne,className:"text-primary-600 hover:text-primary-900 dark:hover:text-primary-400 mr-3",children:t.jsx($,{className:"inline"})}):t.jsx(t.Fragment,{}),t.jsx("button",{onClick:()=>ee(e),className:"text-primary-600 hover:text-primary-900 dark:hover:text-primary-400 mr-3",children:t.jsx(_,{className:"inline"})}),t.jsx("button",{onClick:()=>ae(e),className:"text-red-600 hover:text-red-900 dark:hover:text-red-400",children:t.jsx(M,{className:"inline"})})]})]},e.id))})]})})}),t.jsx("div",{className:"sm:hidden space-y-4",children:Me.map(e=>t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"p-4 cursor-pointer",onClick:()=>{return t=e.id,void Y(z===t?null:t);var t},children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:e.task?.name||"Unknown Task"}),t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.customer?.name||"Unknown Customer"," / ",e.project?.name||"Unknown Project"]})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mr-2",children:ve(e.duration_minutes,e.start_time,e.end_time)}),t.jsx(F,{className:"transition-transform "+(z===e.id?"transform rotate-90":"")})]})]}),t.jsxs("div",{className:"mt-2 flex items-center text-xs text-gray-500 dark:text-gray-400",children:[t.jsx(f,{className:"mr-1"}),t.jsx("span",{children:e.date?Ce(new Date(e.date)):e.start_time?Ce(new Date(e.start_time)):"-"})]})]}),z===e.id&&t.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-gray-100 dark:border-gray-700",children:[t.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[t.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(e.billable?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"),children:[t.jsx(A,{className:"mr-1 "+(e.billable?"opacity-100":"opacity-50")}),e.billable?"Billable":"Non-billable"]}),t.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(e.active?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"),children:[t.jsx(P,{className:"mr-1 "+(e.active?"opacity-100":"opacity-50")}),e.active?"Active":"Inactive"]})]}),e.rate&&t.jsxs("div",{className:"mb-3",children:[t.jsx("h4",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Rate:"}),t.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[we(e.rate),"/hr"]})]}),e.description&&t.jsxs("div",{className:"mb-3",children:[t.jsx("h4",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Description:"}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.description})]}),t.jsxs("div",{className:"flex justify-between mt-3 pt-3 border-t border-gray-100 dark:border-gray-700",children:[t.jsx("div",{className:"flex space-x-2",children:!e.end_time&&e.start_time?t.jsxs("button",{onClick:e=>{e.stopPropagation(),Ne()},className:"btn btn-sm btn-primary flex items-center","aria-label":"Stop timer",children:[t.jsx($,{className:"mr-1"})," Stop"]}):t.jsx(t.Fragment,{})}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsxs("button",{onClick:t=>{t.stopPropagation(),ee(e)},className:"btn btn-sm btn-secondary flex items-center","aria-label":"Edit time entry",children:[t.jsx(_,{className:"mr-1"})," Edit"]}),t.jsxs("button",{onClick:t=>{t.stopPropagation(),ae(e)},className:"btn btn-sm btn-danger flex items-center","aria-label":"Delete time entry",children:[t.jsx(M,{className:"mr-1"})," Delete"]})]})]})]})]},e.id))})]}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6 text-center",children:[t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:H||Object.values(L).some(e=>e)?"No time entries match your search or filters.":"No time entries found. Add your first time entry to get started."}),H||Object.values(L).some(e=>e)?t.jsxs("div",{className:"flex justify-center space-x-2",children:[H&&t.jsx("button",{onClick:()=>q(""),className:"btn btn-secondary",children:"Clear Search"}),Object.values(L).some(e=>e)&&t.jsx("button",{onClick:fe,className:"btn btn-secondary",children:"Clear Filters"})]}):i.length>0&&l.length>0&&o.length>0?t.jsxs("button",{onClick:()=>ee(),className:"btn btn-primary flex items-center justify-center mx-auto",children:[t.jsx(C,{className:"mr-2"})," Add Time Entry"]}):t.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[0===i.length&&t.jsxs("button",{onClick:()=>window.location.href="/tasks",className:"btn btn-primary flex items-center justify-center",children:[t.jsx(C,{className:"mr-2"})," Add Task First"]}),0===l.length&&t.jsxs("button",{onClick:()=>window.location.href="/projects",className:"btn btn-primary flex items-center justify-center",children:[t.jsx(C,{className:"mr-2"})," Add Project First"]}),0===o.length&&t.jsxs("button",{onClick:()=>window.location.href="/customers",className:"btn btn-primary flex items-center justify-center",children:[t.jsx(C,{className:"mr-2"})," Add Customer First"]})]})]}),j&&t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[t.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:te,children:t.jsx("div",{className:"absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"})}),t.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"​"}),t.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:S?"Edit Time Entry":"Add Time Entry"}),I&&t.jsx("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-3 rounded-md text-sm",children:I}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!T.task_id)return void R("Please select a task");if(!T.project_id)return void R("Please select a project");if(!T.customer_id)return void R("Please select a customer");if(!T.date)return void R("Date is required");const t=parseInt(T.duration_hours)||0,a=parseInt(T.duration_minutes)||0;if(0===t&&0===a)return void R("Please enter a duration");const r=60*t+a,i=T.rate?parseFloat(T.rate):null;try{if(R(null),S){const{error:e}=await pe.from("time_entries").update({task_id:T.task_id,project_id:T.project_id,customer_id:T.customer_id,date:T.date,duration_minutes:r,description:T.description,billable:T.billable,active:T.active,rate:i}).eq("id",S.id);if(e)throw console.error("Error updating time entry:",e),e}else{const{error:e}=await pe.from("time_entries").insert([{user_id:s?.id,task_id:T.task_id,project_id:T.project_id,customer_id:T.customer_id,date:T.date,duration_minutes:r,description:T.description,billable:T.billable,active:T.active,rate:i}]);if(e)throw console.error("Error creating time entry:",e),e}te(),V()}catch(n){console.error("Error in handleSubmit:",n),R(n.message)}},children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{htmlFor:"customer_id",className:"label",children:["Customer ",t.jsx("span",{className:"text-red-600",children:"*"})]}),t.jsxs("select",{id:"customer_id",name:"customer_id",value:T.customer_id,onChange:e=>{const t=e.target.value;E(e=>({...e,customer_id:t,project_id:"",task_id:""}))},className:"input",required:!0,children:[t.jsx("option",{value:"",children:"Select a customer"}),o.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{htmlFor:"project_id",className:"label",children:["Project ",t.jsx("span",{className:"text-red-600",children:"*"})]}),t.jsxs("select",{id:"project_id",name:"project_id",value:T.project_id,onChange:e=>{const t=e.target.value;E(e=>({...e,project_id:t,task_id:""}))},className:"input",required:!0,disabled:!T.customer_id,children:[t.jsx("option",{value:"",children:"Select a project"}),Se.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]}),!T.customer_id&&t.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Select a customer first"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{htmlFor:"task_id",className:"label",children:["Task ",t.jsx("span",{className:"text-red-600",children:"*"})]}),t.jsxs("select",{id:"task_id",name:"task_id",value:T.task_id,onChange:ge,className:"input",required:!0,children:[t.jsx("option",{value:"",children:"Select a task"}),i.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{htmlFor:"date",className:"label",children:["Date ",t.jsx("span",{className:"text-red-600",children:"*"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",id:"date",name:"date",value:T.date,onChange:ge,className:"input pl-10",required:!0}),t.jsx(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{className:"label",children:["Duration ",t.jsx("span",{className:"text-red-600",children:"*"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"number",id:"duration_hours",name:"duration_hours",value:T.duration_hours,onChange:ge,className:"input pl-10",min:"0",placeholder:"Hours"}),t.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),t.jsx("div",{children:t.jsx("input",{type:"number",id:"duration_minutes",name:"duration_minutes",value:T.duration_minutes,onChange:ge,className:"input",min:"0",max:"59",placeholder:"Minutes"})})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"rate",className:"label",children:"Rate (per hour)"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"number",id:"rate",name:"rate",value:T.rate,onChange:ge,className:"input pl-10",min:"0",step:"0.01",placeholder:"0.00"}),t.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:"kr"})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"description",className:"label",children:"Description"}),t.jsx("textarea",{id:"description",name:"description",value:T.description,onChange:ge,className:"input",rows:3,placeholder:"What did you work on?"})]}),t.jsxs("div",{className:"mb-4 flex space-x-6",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",id:"billable",name:"billable",checked:T.billable,onChange:ye,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),t.jsx("label",{htmlFor:"billable",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:"Billable"})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",id:"active",name:"active",checked:T.active,onChange:ye,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),t.jsx("label",{htmlFor:"active",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:"Active"})]})]}),t.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[t.jsx("button",{type:"button",onClick:te,className:"btn btn-secondary",children:"Cancel"}),t.jsx("button",{type:"submit",className:"btn btn-primary",children:S?"Update":"Create"})]})]})]})})]})}),k&&t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[t.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:re,children:t.jsx("div",{className:"absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"})}),t.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"​"}),t.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Delete Time Entry"}),I&&t.jsx("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-3 rounded-md text-sm",children:I}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Are you sure you want to delete this time entry? This action cannot be undone."}),t.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[t.jsx("button",{type:"button",onClick:re,className:"btn btn-secondary",children:"Cancel"}),t.jsx("button",{type:"button",onClick:async()=>{if(S)try{const{error:e}=await pe.from("time_entries").delete().eq("id",S.id);if(e)throw e;re(),V()}catch(e){R(e.message)}},className:"btn btn-danger",children:"Delete"})]})]})})]})}),U&&t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[t.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:ie,children:t.jsx("div",{className:"absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"})}),t.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"​"}),t.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Filter Time Entries"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"customer",className:"label",children:"Customer"}),t.jsxs("select",{id:"customer",name:"customer",value:L.customer,onChange:be,className:"input",children:[t.jsx("option",{value:"",children:"All Customers"}),o.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"project",className:"label",children:"Project"}),t.jsxs("select",{id:"project",name:"project",value:L.project,onChange:be,className:"input",children:[t.jsx("option",{value:"",children:"All Projects"}),l.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"task",className:"label",children:"Task"}),t.jsxs("select",{id:"task",name:"task",value:L.task,onChange:be,className:"input",children:[t.jsx("option",{value:"",children:"All Tasks"}),i.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"dateFrom",className:"label",children:"From Date"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",id:"dateFrom",name:"dateFrom",value:L.dateFrom,onChange:be,className:"input pl-10"}),t.jsx(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"dateTo",className:"label",children:"To Date"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",id:"dateTo",name:"dateTo",value:L.dateTo,onChange:be,className:"input pl-10"}),t.jsx(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"billable",className:"label",children:"Billable"}),t.jsxs("select",{id:"billable",name:"billable",value:L.billable,onChange:be,className:"input",children:[t.jsx("option",{value:"",children:"All"}),t.jsx("option",{value:"yes",children:"Yes"}),t.jsx("option",{value:"no",children:"No"})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"active",className:"label",children:"Active"}),t.jsxs("select",{id:"active",name:"active",value:L.active,onChange:be,className:"input",children:[t.jsx("option",{value:"",children:"All"}),t.jsx("option",{value:"yes",children:"Yes"}),t.jsx("option",{value:"no",children:"No"})]})]})]})]}),t.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[t.jsx("button",{type:"button",onClick:fe,className:"btn btn-secondary",children:"Reset"}),t.jsx("button",{type:"button",onClick:()=>{ie(),V()},className:"btn btn-primary",children:"Apply Filters"})]})]})})]})})]})}function Ae(){const{user:s}=je(),[a,r]=e.useState([]),[i,l]=e.useState([]),[d,m]=e.useState([]),[x,h]=e.useState(!0),[u,g]=e.useState([]),[p,y]=e.useState(0),[b,N]=e.useState(0),[k,v]=e.useState(0),[w,C]=e.useState([]),[_,M]=e.useState([]),[S,F]=e.useState({dateFrom:se(ke(new Date),"yyyy-MM-dd"),dateTo:se(ve(new Date),"yyyy-MM-dd"),customer:"",project:"",groupBy:"customer",billableOnly:!1}),[D,T]=e.useState(!1),[$,P]=e.useState("week"),G=e.useRef(null),[Q,X]=e.useState(!1),[Z,ee]=e.useState(null),[te,ae]=e.useState({timeEntriesCount:0,filteredEntriesCount:0,reportDataCount:0,renderCount:0,chartDimensions:{width:0,height:0},errors:[],rawData:null,clientDebug:{totalEntries:0,entriesWithCustomer:0,entriesWithoutCustomer:0,uniqueCustomers:[],customerBreakdown:{}}}),re=e.useRef(0);e.useEffect(()=>{re.current+=1,ae(e=>({...e,renderCount:re.current}))}),e.useEffect(()=>{s&&(he(),ye(),be())},[s]);const ie=e.useCallback(e=>{if(e.duration_minutes)return 60*e.duration_minutes;if(e.start_time&&e.end_time){const t=new Date(e.start_time),s=new Date(e.end_time);return ue(s,t)}if(e.start_time){const t=new Date(e.start_time);return ue(new Date,t)}return 0},[]),ne=e.useCallback(e=>e.filter(e=>{const t=e.date?new Date(e.date):e.start_time?new Date(e.start_time):new Date;if(S.dateFrom){const e=new Date(S.dateFrom);if(e.setHours(0,0,0,0),t<e)return!1}if(S.dateTo){const e=new Date(S.dateTo);if(e.setHours(23,59,59,999),t>e)return!1}return(!S.customer||e.customer_id===S.customer)&&(!S.project&&!(S.billableOnly&&!e.billable))}),[S]),ce=e.useCallback(()=>{const e=ne(a);ae(t=>({...t,filteredEntriesCount:e.length}));const t={};let s=0,r=0,i=0;e.forEach(e=>{const a=ie(e);let n="";switch(S.groupBy){case"customer":n=e.customer?.name||"Unknown Customer";break;case"project":n="Unknown Project";break;case"task":n=e.task?.name||"Unknown Task";break;case"day":const t=e.date?new Date(e.date):e.start_time?new Date(e.start_time):new Date;n=se(t,"yyyy-MM-dd")}t[n]||(t[n]={total:0,billable:0,nonBillable:0}),t[n].total+=a,e.billable?(t[n].billable+=a,r+=a):(t[n].nonBillable+=a,i+=a),s+=a});const n=Object.entries(t).map(([e,t])=>({name:"day"===S.groupBy?Ce(oe(e),"dd MMM"):e,value:Math.round(t.total/3600*100)/100,seconds:t.total,billableHours:Math.round(t.billable/3600*100)/100,nonBillableHours:Math.round(t.nonBillable/3600*100)/100}));"day"===S.groupBy?n.sort((e,t)=>{const s=new Date(e.name),a=new Date(t.name);return s.getTime()-a.getTime()}):n.sort((e,t)=>t.seconds-e.seconds),g(n),y(Math.round(s/3600*100)/100),N(Math.round(r/3600*100)/100),v(Math.round(i/3600*100)/100),ae(e=>({...e,reportDataCount:n.length}))},[a,S,ie,ne]),me=e.useCallback(()=>{const e=ne(a),t=[],s={};e.forEach(e=>{const t=e.date?new Date(e.date):e.start_time?new Date(e.start_time):new Date;let a="";switch($){case"week":const e=ke(t);a=se(e,"yyyy-MM-dd");break;case"month":a=se(t,"yyyy-MM");break;case"quarter":const s=Math.floor(t.getMonth()/3)+1;a=`${t.getFullYear()}-Q${s}`}s[a]||(s[a]=[]),s[a].push(e)}),Object.entries(s).forEach(([e,s])=>{let a=0,r=0,i=0;s.forEach(e=>{const t=ie(e);a+=t,e.billable?r+=t:i+=t});const n=a/3600,l=r/3600,d=i/3600;t.push({period:"week"===$?`Week of ${Ce(oe(e))}`:"month"===$?_e(oe(e+"-01")):e,totalHours:Math.round(100*n)/100,billableHours:Math.round(100*l)/100,nonBillableHours:Math.round(100*d)/100,billablePercentage:n>0?Math.round(l/n*100):0})}),t.sort((e,t)=>e.period.localeCompare(t.period)),C(t)},[a,$,ie,ne]),xe=e.useCallback(()=>{const e={};let t=0,s=0,r=0;const i=[],n={};a.forEach(a=>{t++,console.log("Time entry structure:",{id:a.id,customer_id:a.customer_id,customer:a.customer});const l=a.customer;l&&a.customer_id?(s++,i.includes(l.name)||i.push(l.name),n[l.name]=(n[l.name]||0)+1,e[l.id]||(e[l.id]={entries:[],customer:l}),e[l.id].entries.push(a)):(r++,console.log("Entry without customer:",{entryId:a.id,customer_id:a.customer_id,hasCustomer:!!a.customer}))}),ae(e=>({...e,clientDebug:{totalEntries:t,entriesWithCustomer:s,entriesWithoutCustomer:r,uniqueCustomers:i,customerBreakdown:n}})),console.log("Client debug info:",{totalEntries:t,entriesWithCustomer:s,entriesWithoutCustomer:r,uniqueCustomers:i,customerBreakdown:n,clientGroupsKeys:Object.keys(e)});const l=Object.entries(e).map(([e,{entries:t,customer:s}])=>{let a=0,r=0,i=0,n=0;t.forEach(e=>{const t=ie(e);if(a+=t,e.billable){if(r+=t,e.rate&&e.rate>0){n+=t/3600*e.rate}}else i+=t});const l=a/3600,d=r/3600,c=i/3600;return{clientId:e,clientName:s.name,totalHours:Math.round(100*l)/100,billableHours:Math.round(100*d)/100,nonBillableHours:Math.round(100*c)/100,billableAmount:Math.round(100*n)/100}}).filter(e=>e.totalHours>0);l.sort((e,t)=>t.totalHours-e.totalHours),console.log("Final client summaries:",l),M(l)},[a,ie]);e.useEffect(()=>{a.length>0&&(ce(),me(),xe()),ae(e=>({...e,timeEntriesCount:a.length}))},[a,ce,me,xe]);const he=async()=>{try{h(!0);const{data:e,error:t}=await pe.from("time_entries").select("\n          *,\n          task:tasks(id, name),\n          customer:customers(id, name)\n        ").eq("user_id",s?.id).order("start_time",{ascending:!1});if(t)throw console.error("Supabase error:",t),ae(e=>({...e,errors:[...e.errors,`Fetch error: ${t.message}`]})),t;ae(t=>({...t,rawData:e})),r(e||[])}catch(e){console.error("Error fetching time entries:",e.message),ae(t=>({...t,errors:[...t.errors,`Fetch error: ${e.message}`]}))}finally{h(!1)}},ye=async()=>{try{const{data:e,error:t}=await pe.from("customers").select("id, name").eq("user_id",s?.id).order("name");if(t)throw t;l(e||[])}catch(e){console.error("Error fetching customers:",e.message),ae(t=>({...t,errors:[...t.errors,`Customer fetch error: ${e.message}`]}))}},be=async()=>{try{const{data:e,error:t}=await pe.from("projects").select("id, name, customer_id").eq("user_id",s?.id).order("name");if(t)throw t;const a=(e||[]).map(e=>({id:e.id,name:e.name,customer_id:e.customer_id}));m(a)}catch(e){console.error("Error fetching projects:",e.message),ae(t=>({...t,errors:[...t.errors,`Project fetch error: ${e.message}`]}))}},fe=async()=>{try{const{data:e}=await pe.from("customers").select("id, name").eq("user_id",s?.id),{data:t}=await pe.from("projects").select("\n          id, \n          name, \n          customer_id,\n          customer:customers(id, name)\n        ").eq("user_id",s?.id),{data:a}=await pe.from("tasks").select("id, name").eq("user_id",s?.id),{data:r}=await pe.from("time_entries").select("\n          task_id,\n          customer:customers(id, name)\n        ").eq("user_id",s?.id),i=(e||[]).map(e=>{const s=(t||[]).filter(t=>t.customer_id===e.id).length;return{id:e.id,name:e.name,projectCount:s}}),n=(t||[]).map(e=>({id:e.id,name:e.name,customerName:e.customer?.name||"Unknown",taskCount:0})),l=(a||[]).map(e=>{const t=(r||[]).filter(t=>t.task_id===e.id),s=t.length,a=t.length>0&&t[0].customer?t[0].customer.name:"Unknown";return{id:e.id,name:e.name,entryCount:s,customerName:a}});ee({totalCustomers:e?.length||0,totalProjects:t?.length||0,totalTasks:a?.length||0,customersWithProjects:i,projectsWithTasks:n,tasksWithEntries:l})}catch(e){console.error("Error fetching database state:",e),ae(t=>({...t,errors:[...t.errors,`Database state error: ${e.message}`]}))}},Ne=()=>{T(!0)},Me=()=>{T(!1)},Se=e=>{const{name:t,value:s,type:a}=e.target,r="checkbox"===a?e.target.checked:void 0;F(e=>({...e,[t]:"checkbox"===a?r:s}))},Fe=e=>{const t=new Date;switch(e){case"today":F(e=>({...e,dateFrom:se(t,"yyyy-MM-dd"),dateTo:se(t,"yyyy-MM-dd")}));break;case"thisWeek":F(e=>({...e,dateFrom:se(ke(t),"yyyy-MM-dd"),dateTo:se(ve(t),"yyyy-MM-dd")}));break;case"thisMonth":F(e=>({...e,dateFrom:se(le(t),"yyyy-MM-dd"),dateTo:se(de(t),"yyyy-MM-dd")}));break;case"lastMonth":const e=new Date(t.getFullYear(),t.getMonth()-1,1);F(t=>({...t,dateFrom:se(le(e),"yyyy-MM-dd"),dateTo:se(de(e),"yyyy-MM-dd")}));break;case"allTime":F(e=>({...e,dateFrom:"",dateTo:""}))}},De=e=>`${Math.floor(e/3600)}h ${Math.floor(e%3600/60)}m`,Te=S.customer?d.filter(e=>e.customer_id===S.customer):d,Ee=()=>{X(!Q),Q||Z||fe()},Ae=async()=>{try{h(!0);let e="";const{data:t}=await pe.from("customers").select("id").eq("user_id",s?.id).limit(1);if(t&&t.length>0)e=t[0].id;else{const{data:t,error:a}=await pe.from("customers").insert({user_id:s?.id,name:"Sample Customer",email:"sample@example.com"}).select("id").single();if(a)throw a;e=t.id}const{data:a,error:r}=await pe.from("projects").insert({user_id:s?.id,customer_id:e,name:"Sample Project",description:"A sample project for testing"}).select("id").single();if(r)throw r;const{data:i,error:n}=await pe.from("tasks").insert({user_id:s?.id,name:"Sample Task",description:"A sample task for testing"}).select("id").single();if(n)throw n;const l=new Date,d=[];for(let o=0;o<7;o++){const t=new Date;t.setDate(l.getDate()-o);const a=Math.floor(3*Math.random())+1;for(let r=0;r<a;r++){const a=Math.random()>.5,n=Math.random()>.3;if(a){const a=Math.floor(210*Math.random())+30;d.push({user_id:s?.id,task_id:i.id,customer_id:e,date:se(t,"yyyy-MM-dd"),duration_minutes:a,billable:n,description:`Sample ${n?"billable":"non-billable"} work item ${r+1} for ${Ce(t,"dd MMM")}`})}else{const a=9+Math.floor(8*Math.random()),l=3*Math.random()+.5,c=new Date(t);c.setHours(a,0,0,0);const o=new Date(c);o.setHours(c.getHours()+Math.floor(l)),o.setMinutes(l%1*60),d.push({user_id:s?.id,task_id:i.id,customer_id:e,start_time:c.toISOString(),end_time:o.toISOString(),billable:n,description:`Sample ${n?"billable":"non-billable"} time entry ${r+1} for ${Ce(t,"dd MMM")}`})}}}const{error:c}=await pe.from("time_entries").insert(d);if(c)throw c;await he(),await ye(),await be(),alert("Sample data created successfully with direct customer relationships.")}catch(e){console.error("Error creating sample data:",e),alert(`Failed to create sample data: ${e.message}`)}finally{h(!1)}},Be=p>0?Math.round(b/p*100):0;return t.jsxs("div",{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4 sm:mb-0",children:"Reports"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[!Q&&t.jsxs("button",{onClick:Ee,className:"btn btn-secondary flex items-center justify-center",children:[t.jsx(H,{className:"mr-2"})," Debug"]}),Q&&t.jsxs("button",{onClick:Ee,className:"btn btn-secondary flex items-center justify-center",children:[t.jsx(H,{className:"mr-2"})," Hide Debug"]}),t.jsxs("button",{onClick:Ne,className:"btn btn-secondary flex items-center justify-center",children:[t.jsx(B,{className:"mr-2"})," Filters"]}),t.jsxs("button",{onClick:()=>{if(0!==u.length)try{let e="data:text/csv;charset=utf-8,";e+=`${S.groupBy.charAt(0).toUpperCase()+S.groupBy.slice(1)},Total Hours,Billable Hours,Non-Billable Hours,Duration\n`,u.forEach(t=>{e+=`"${t.name}",${t.value},${t.billableHours},${t.nonBillableHours},${De(t.seconds)}\n`}),e+=`Total,${p},${b},${k},${De(3600*p)}\n`;const t=encodeURI(e),s=document.createElement("a");s.setAttribute("href",t),s.setAttribute("download",`time-report-by-${S.groupBy}-${se(new Date,"yyyy-MM-dd")}.csv`),document.body.appendChild(s),s.click(),document.body.removeChild(s)}catch(e){console.error("Error exporting CSV:",e),alert("Failed to export CSV. Please check console for details.")}},className:"btn btn-secondary flex items-center justify-center",disabled:0===u.length,children:[t.jsx(q,{className:"mr-2"})," Export CSV"]}),t.jsxs("button",{onClick:()=>{if(0!==u.length)try{const e=new ge,t=`Time Report by ${S.groupBy.charAt(0).toUpperCase()+S.groupBy.slice(1)}`;e.setFontSize(18),e.text(t,14,22),e.setFontSize(11);let s="Period: ";S.dateFrom?s+=`From ${Ce(oe(S.dateFrom))} `:s+="All time ",S.dateTo?s+=`to ${Ce(oe(S.dateTo))}`:s+="to Present",e.text(s,14,32),e.text(`Total Hours: ${p.toFixed(2)} | Billable: ${b.toFixed(2)} | Non-Billable: ${k.toFixed(2)}`,14,39);const a=[S.groupBy.charAt(0).toUpperCase()+S.groupBy.slice(1),"Total Hours","Billable Hours","Non-Billable Hours","Percentage"],r=u.map(e=>[e.name,e.value.toFixed(2),e.billableHours.toFixed(2),e.nonBillableHours.toFixed(2),`${(e.value/p*100).toFixed(1)}%`]);r.push(["Total",p.toFixed(2),b.toFixed(2),k.toFixed(2),"100%"]),e.autoTable({head:[a],body:r,startY:50,theme:"grid",styles:{fontSize:10,cellPadding:3},headStyles:{fillColor:[41,128,185],textColor:255},footStyles:{fillColor:[220,220,220],textColor:0,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]}}),e.save(`time-report-by-${S.groupBy}-${se(new Date,"yyyy-MM-dd")}.pdf`)}catch(e){console.error("Error exporting PDF:",e),alert("Failed to export PDF. Please check console for details.")}},className:"btn btn-secondary flex items-center justify-center",disabled:0===u.length,children:[t.jsx(E,{className:"mr-2"})," Export PDF"]}),t.jsxs("button",{onClick:()=>{if(G.current)try{const e=window.open("","_blank");if(!e)return void alert("Pop-up blocked. Please allow pop-ups for this site to print reports.");e.document.write(`\n        <html>\n          <head>\n            <title>Time Report</title>\n            <style>\n              body { font-family: Arial, sans-serif; padding: 20px; }\n              h1 { color: #333; }\n              table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n              th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }\n              th { background-color: #f2f2f2; }\n              .total-row { font-weight: bold; background-color: #f2f2f2; }\n              .header { margin-bottom: 20px; }\n              .filters { margin-bottom: 15px; color: #666; }\n              @media print {\n                button { display: none; }\n              }\n            </style>\n          </head>\n          <body>\n            <div class="header">\n              <h1>Time Report by ${S.groupBy.charAt(0).toUpperCase()+S.groupBy.slice(1)}</h1>\n              <div class="filters">\n                <p>\n                  Period: \n                  ${S.dateFrom?`From ${Ce(oe(S.dateFrom))}`:"All time"}\n                  ${S.dateTo?` to ${Ce(oe(S.dateTo))}`:" to Present"}\n                </p>\n                <p>Total Hours: ${p.toFixed(2)} | Billable: ${b.toFixed(2)} | Non-Billable: ${k.toFixed(2)}</p>\n              </div>\n            </div>\n            <table>\n              <thead>\n                <tr>\n                  <th>${S.groupBy.charAt(0).toUpperCase()+S.groupBy.slice(1)}</th>\n                  <th>Total Hours</th>\n                  <th>Billable Hours</th>\n                  <th>Non-Billable Hours</th>\n                  <th>Percentage</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${u.map(e=>`\n                  <tr>\n                    <td>${e.name}</td>\n                    <td>${e.value.toFixed(2)}</td>\n                    <td>${e.billableHours.toFixed(2)}</td>\n                    <td>${e.nonBillableHours.toFixed(2)}</td>\n                    <td>${(e.value/p*100).toFixed(1)}%</td>\n                  </tr>\n                `).join("")}\n                <tr class="total-row">\n                  <td>Total</td>\n                  <td>${p.toFixed(2)}</td>\n                  <td>${b.toFixed(2)}</td>\n                  <td>${k.toFixed(2)}</td>\n                  <td>100%</td>\n                </tr>\n              </tbody>\n            </table>\n            <button onclick="window.print()">Print</button>\n          </body>\n        </html>\n      `),e.document.close(),setTimeout(()=>{e.print()},500)}catch(e){console.error("Error printing report:",e),alert("Failed to print report. Please check console for details.")}},className:"btn btn-primary flex items-center justify-center",disabled:0===u.length,children:[t.jsx(I,{className:"mr-2"})," Print"]})]})]}),Q&&t.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-6",children:[t.jsxs("h2",{className:"text-lg font-semibold text-red-800 dark:text-red-400 mb-2 flex items-center",children:[t.jsx(H,{className:"mr-2"})," Debug Information"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-red-700 dark:text-red-300",children:"Data Stats:"}),t.jsxs("ul",{className:"list-disc list-inside text-sm text-red-600 dark:text-red-300",children:[t.jsxs("li",{children:["Total Time Entries: ",te.timeEntriesCount]}),t.jsxs("li",{children:["Filtered Entries: ",te.filteredEntriesCount]}),t.jsxs("li",{children:["Report Data Items: ",te.reportDataCount]}),t.jsxs("li",{children:["Client Summaries: ",_.length]}),t.jsxs("li",{children:["Component Renders: ",te.renderCount]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-red-700 dark:text-red-300",children:"Current Filters:"}),t.jsxs("ul",{className:"list-disc list-inside text-sm text-red-600 dark:text-red-300",children:[t.jsxs("li",{children:["Date Range: ",S.dateFrom||"All"," to ",S.dateTo||"Present"]}),t.jsxs("li",{children:["Customer: ",S.customer?i.find(e=>e.id===S.customer)?.name:"All"]}),t.jsxs("li",{children:["Project: ",S.project?d.find(e=>e.id===S.project)?.name:"All"]}),t.jsxs("li",{children:["Group By: ",S.groupBy]}),t.jsxs("li",{children:["Billable Only: ",S.billableOnly?"Yes":"No"]})]})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"font-medium text-red-700 dark:text-red-300",children:"Client Debug Info:"}),t.jsxs("ul",{className:"list-disc list-inside text-sm text-red-600 dark:text-red-300",children:[t.jsxs("li",{children:["Total Entries: ",te.clientDebug.totalEntries]}),t.jsxs("li",{children:["Entries with Customer: ",te.clientDebug.entriesWithCustomer]}),t.jsxs("li",{children:["Entries without Customer: ",te.clientDebug.entriesWithoutCustomer]}),t.jsxs("li",{children:["Unique Customers: ",te.clientDebug.uniqueCustomers.join(", ")]}),t.jsxs("li",{children:["Customer Breakdown: ",JSON.stringify(te.clientDebug.customerBreakdown)]})]})]}),Z&&t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"font-medium text-red-700 dark:text-red-300",children:"Database State:"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-2",children:[t.jsxs("div",{children:[t.jsxs("h4",{className:"font-medium text-red-600 dark:text-red-400",children:["Customers (",Z.totalCustomers,"):"]}),t.jsx("ul",{className:"list-disc list-inside text-xs text-red-600 dark:text-red-300",children:Z.customersWithProjects.map(e=>t.jsxs("li",{children:[e.name," (",e.projectCount," projects)"]},e.id))})]}),t.jsxs("div",{children:[t.jsxs("h4",{className:"font-medium text-red-600 dark:text-red-400",children:["Projects (",Z.totalProjects,"):"]}),t.jsx("ul",{className:"list-disc list-inside text-xs text-red-600 dark:text-red-300",children:Z.projectsWithTasks.map(e=>t.jsxs("li",{children:[e.name," - ",e.customerName," (",e.taskCount," tasks)"]},e.id))})]}),t.jsxs("div",{children:[t.jsxs("h4",{className:"font-medium text-red-600 dark:text-red-400",children:["Tasks (",Z.totalTasks,"):"]}),t.jsx("ul",{className:"list-disc list-inside text-xs text-red-600 dark:text-red-300",children:Z.tasksWithEntries.map(e=>t.jsxs("li",{children:[e.name," - ",e.customerName," (",e.entryCount," entries)"]},e.id))})]})]})]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsx("button",{onClick:async()=>{try{h(!0);const{data:e,error:t}=await pe.from("customers").select("id").eq("user_id",s?.id).eq("name","Det Mindre Bureau").single();if(t||!e)throw new Error("Could not find Det Mindre Bureau customer");const{error:a}=await pe.from("time_entries").update({customer_id:e.id}).eq("user_id",s?.id).is("customer_id",null);if(a)throw a;await he(),await fe(),alert("Fixed customer attribution for remaining time entries.")}catch(e){console.error("Error fixing customer attribution:",e),alert(`Failed to fix customer attribution: ${e.message}`)}finally{h(!1)}},className:"px-3 py-1 bg-green-100 hover:bg-green-200 text-green-800 text-sm rounded",children:"Fix Customer Attribution"}),t.jsx("button",{onClick:Ae,className:"px-3 py-1 bg-red-100 hover:bg-red-200 text-red-800 text-sm rounded",children:"Create Sample Data"}),t.jsx("button",{onClick:he,className:"px-3 py-1 bg-red-100 hover:bg-red-200 text-red-800 text-sm rounded",children:"Reload Data"}),t.jsx("button",{onClick:()=>Fe("allTime"),className:"px-3 py-1 bg-red-100 hover:bg-red-200 text-red-800 text-sm rounded",children:"Show All Time"}),t.jsx("button",{onClick:fe,className:"px-3 py-1 bg-red-100 hover:bg-red-200 text-red-800 text-sm rounded",children:"Check Database State"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(c,{className:"h-8 w-8 text-blue-500"}),t.jsxs("div",{className:"ml-4",children:[t.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total Hours"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:p.toFixed(1)})]})]})}),t.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(A,{className:"h-8 w-8 text-green-500"}),t.jsxs("div",{className:"ml-4",children:[t.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Billable Hours"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:b.toFixed(1)})]})]})}),t.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(c,{className:"h-8 w-8 text-orange-500"}),t.jsxs("div",{className:"ml-4",children:[t.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Non-Billable Hours"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:k.toFixed(1)})]})]})}),t.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(o,{className:"h-8 w-8 text-purple-500"}),t.jsxs("div",{className:"ml-4",children:[t.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Billable %"}),t.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[Be,"%"]})]})]})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4 mb-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Quick Date Range"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsx("button",{onClick:()=>Fe("today"),className:"px-3 py-1 rounded-md text-sm "+(S.dateFrom===se(new Date,"yyyy-MM-dd")&&S.dateTo===se(new Date,"yyyy-MM-dd")?"bg-primary-100 text-primary-800 dark:bg-primary-900/20 dark:text-primary-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"Today"}),t.jsx("button",{onClick:()=>Fe("thisWeek"),className:"px-3 py-1 rounded-md text-sm "+(S.dateFrom===se(ke(new Date),"yyyy-MM-dd")&&S.dateTo===se(ve(new Date),"yyyy-MM-dd")?"bg-primary-100 text-primary-800 dark:bg-primary-900/20 dark:text-primary-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"This Week"}),t.jsx("button",{onClick:()=>Fe("thisMonth"),className:"px-3 py-1 rounded-md text-sm "+(S.dateFrom===se(le(new Date),"yyyy-MM-dd")&&S.dateTo===se(de(new Date),"yyyy-MM-dd")?"bg-primary-100 text-primary-800 dark:bg-primary-900/20 dark:text-primary-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"This Month"}),t.jsx("button",{onClick:()=>Fe("lastMonth"),className:"px-3 py-1 rounded-md text-sm bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600",children:"Last Month"}),t.jsx("button",{onClick:()=>Fe("allTime"),className:"px-3 py-1 rounded-md text-sm "+(S.dateFrom||S.dateTo?"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600":"bg-primary-100 text-primary-800 dark:bg-primary-900/20 dark:text-primary-400"),children:"All Time"})]}),t.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center text-sm text-gray-600 dark:text-gray-400",children:[t.jsxs("div",{className:"flex items-center mb-2 sm:mb-0 sm:mr-4",children:[t.jsx(f,{className:"mr-1"}),t.jsx("span",{children:S.dateFrom?`From: ${Ce(oe(S.dateFrom))}`:"From: All time"})]}),t.jsxs("div",{className:"flex items-center mb-2 sm:mb-0 sm:mr-4",children:[t.jsx(f,{className:"mr-1"}),t.jsx("span",{children:S.dateTo?`To: ${Ce(oe(S.dateTo))}`:"To: Present"})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx(c,{className:"mr-1"}),t.jsxs("span",{children:["Total: ",p," hours (",Be,"% billable)"]})]})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4 mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Hours by Period"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>P("week"),className:"px-3 py-1 rounded-md text-sm "+("week"===$?"bg-primary-100 text-primary-800 dark:bg-primary-900/20 dark:text-primary-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"Weekly"}),t.jsx("button",{onClick:()=>P("month"),className:"px-3 py-1 rounded-md text-sm "+("month"===$?"bg-primary-100 text-primary-800 dark:bg-primary-900/20 dark:text-primary-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"Monthly"}),t.jsx("button",{onClick:()=>P("quarter"),className:"px-3 py-1 rounded-md text-sm "+("quarter"===$?"bg-primary-100 text-primary-800 dark:bg-primary-900/20 dark:text-primary-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"Quarterly"})]})]}),w.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Period"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Total Hours"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Billable Hours"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Non-Billable Hours"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Billable %"})]})}),t.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:w.map((e,s)=>t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.period}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 text-right",children:e.totalHours.toFixed(2)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 dark:text-green-400 text-right",children:e.billableHours.toFixed(2)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-orange-600 dark:text-orange-400 text-right",children:e.nonBillableHours.toFixed(2)}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 text-right",children:[e.billablePercentage,"%"]})]},s))})]})}):t.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No data available for the selected period."})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4 mb-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(n,{className:"mr-2 text-primary-600"}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Client Overview"}),t.jsx("span",{className:"ml-2 text-sm text-gray-500 dark:text-gray-400",children:"(All Time Data)"})]}),_.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Client"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Total Hours"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Billable Hours"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Non-Billable Hours"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Billable Amount"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:_.map(e=>t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.clientName}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 text-right",children:e.totalHours.toFixed(2)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 dark:text-green-400 text-right",children:e.billableHours.toFixed(2)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-orange-600 dark:text-orange-400 text-right",children:e.nonBillableHours.toFixed(2)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white text-right font-medium",children:we(e.billableAmount)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:t.jsx("button",{onClick:()=>{F(t=>({...t,customer:e.clientId}))},className:"text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300 text-sm font-medium",children:"Filter for Invoice"})})]},e.clientId))})]})}):t.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No client data available."})]}),t.jsx("div",{ref:G,children:x?t.jsx("div",{className:"flex justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):u.length>0?t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(o,{className:"mr-2 text-primary-600"}),t.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Time by ",S.groupBy.charAt(0).toUpperCase()+S.groupBy.slice(1)]})]}),t.jsx("div",{className:"h-80",children:t.jsx(R,{width:"100%",height:"100%",children:t.jsxs(L,{data:u,margin:{top:20,right:30,left:20,bottom:60},children:[t.jsx(O,{strokeDasharray:"3 3"}),t.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:70,tick:{fontSize:12}}),t.jsx(W,{label:{value:"Hours",angle:-90,position:"insideLeft",style:{textAnchor:"middle"}}}),t.jsx(z,{formatter:(e,t)=>"Billable Hours"===t?[`${e} hours`,"Billable"]:"Non-Billable Hours"===t?[`${e} hours`,"Non-Billable"]:[`${e} hours`,"Total"],labelFormatter:e=>`${S.groupBy.charAt(0).toUpperCase()+S.groupBy.slice(1)}: ${e}`}),t.jsx(Y,{}),t.jsx(J,{dataKey:"billableHours",name:"Billable Hours",fill:"#10b981"}),t.jsx(J,{dataKey:"nonBillableHours",name:"Non-Billable Hours",fill:"#f59e0b"})]})})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(j,{className:"mr-2 text-primary-600"}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Billable vs Non-Billable Distribution"})]}),t.jsx("div",{className:"h-80",children:t.jsx(R,{width:"100%",height:"100%",children:t.jsxs(K,{children:[t.jsx(V,{data:[{name:"Billable Hours",value:b,fill:"#10b981"},{name:"Non-Billable Hours",value:k,fill:"#f59e0b"}],cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,dataKey:"value",label:({name:e,percent:t})=>`${e}: ${(100*t).toFixed(0)}%`}),t.jsx(z,{formatter:e=>[`${e.toFixed(2)} hours`,"Time"]}),t.jsx(Y,{})]})})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4 lg:col-span-2",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Time Summary"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:S.groupBy.charAt(0).toUpperCase()+S.groupBy.slice(1)}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Total Hours"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Billable Hours"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Non-Billable Hours"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Percentage"})]})}),t.jsxs("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:[u.map((e,s)=>t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.name}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 text-right",children:e.value.toFixed(2)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 dark:text-green-400 text-right",children:e.billableHours.toFixed(2)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-orange-600 dark:text-orange-400 text-right",children:e.nonBillableHours.toFixed(2)}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 text-right",children:[(e.value/p*100).toFixed(1),"%"]})]},s)),t.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900 dark:text-white",children:"Total"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900 dark:text-white text-right",children:p.toFixed(2)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-green-600 dark:text-green-400 text-right",children:b.toFixed(2)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-orange-600 dark:text-orange-400 text-right",children:k.toFixed(2)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900 dark:text-white text-right",children:"100%"})]})]})]})})]})]}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6 text-center",children:[t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"No time entries found for the selected filters."}),Q&&t.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded text-left",children:[t.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm mb-2",children:"Debugging Information:"}),t.jsxs("ul",{className:"list-disc list-inside text-sm text-red-600 dark:text-red-300",children:[t.jsxs("li",{children:["Total Time Entries: ",te.timeEntriesCount]}),t.jsxs("li",{children:["Filtered Entries: ",te.filteredEntriesCount]}),t.jsxs("li",{children:["Current Filters: ",JSON.stringify(S)]})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[t.jsx("button",{onClick:Ae,className:"px-3 py-1 bg-red-100 hover:bg-red-200 text-red-800 text-sm rounded",children:"Create Sample Data"}),t.jsx("button",{onClick:()=>Fe("allTime"),className:"px-3 py-1 bg-red-100 hover:bg-red-200 text-red-800 text-sm rounded",children:"Show All Time"})]})]}),t.jsx("button",{onClick:Ne,className:"btn btn-secondary",children:"Adjust Filters"})]})}),D&&t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[t.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:Me,children:t.jsx("div",{className:"absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"})}),t.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"​"}),t.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Report Filters"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"dateFrom",className:"label",children:"From Date"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",id:"dateFrom",name:"dateFrom",value:S.dateFrom,onChange:Se,className:"input pl-10"}),t.jsx(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"dateTo",className:"label",children:"To Date"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",id:"dateTo",name:"dateTo",value:S.dateTo,onChange:Se,className:"input pl-10"}),t.jsx(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"customer",className:"label",children:"Customer"}),t.jsxs("select",{id:"customer",name:"customer",value:S.customer,onChange:Se,className:"input",children:[t.jsx("option",{value:"",children:"All Customers"}),i.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"project",className:"label",children:"Project"}),t.jsxs("select",{id:"project",name:"project",value:S.project,onChange:Se,className:"input",disabled:!S.customer,children:[t.jsx("option",{value:"",children:"All Projects"}),Te.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"groupBy",className:"label",children:"Group By"}),t.jsxs("select",{id:"groupBy",name:"groupBy",value:S.groupBy,onChange:Se,className:"input",children:[t.jsx("option",{value:"customer",children:"Customer"}),t.jsx("option",{value:"project",children:"Project"}),t.jsx("option",{value:"task",children:"Task"}),t.jsx("option",{value:"day",children:"Day"})]})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",id:"billableOnly",name:"billableOnly",checked:S.billableOnly,onChange:Se,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),t.jsx("label",{htmlFor:"billableOnly",className:"ml-2 block text-sm text-gray-900 dark:text-white",children:"Show billable hours only"})]})]}),t.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[t.jsx("button",{type:"button",onClick:Me,className:"btn btn-secondary",children:"Cancel"}),t.jsx("button",{type:"button",onClick:()=>{Me()},className:"btn btn-primary",children:"Apply Filters"})]})]})})]})})]})}function Be(){return t.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen px-4 text-center",children:[t.jsx("h1",{className:"text-6xl font-bold text-primary-600",children:"404"}),t.jsx("h2",{className:"mt-4 text-2xl font-semibold text-gray-900 dark:text-white",children:"Page Not Found"}),t.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"The page you are looking for doesn't exist or has been moved."}),t.jsx(m,{to:"/",className:"mt-6 btn btn-primary",children:"Go to Dashboard"})]})}function $e(){const{user:e,loading:s}=je();return s?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):t.jsxs(G,{children:[t.jsx(Q,{path:"/login",element:e?t.jsx(X,{to:"/"}):t.jsx(Se,{})}),t.jsxs(Q,{path:"/",element:e?t.jsx(fe,{}):t.jsx(X,{to:"/login"}),children:[t.jsx(Q,{index:!0,element:t.jsx(Me,{})}),t.jsx(Q,{path:"customers",element:t.jsx(Fe,{})}),t.jsx(Q,{path:"projects",element:t.jsx(De,{})}),t.jsx(Q,{path:"tasks",element:t.jsx(Te,{})}),t.jsx(Q,{path:"time-entries",element:t.jsx(Ee,{})}),t.jsx(Q,{path:"reports",element:t.jsx(Ae,{})})]}),t.jsx(Q,{path:"*",element:t.jsx(Be,{})})]})}Z.createRoot(document.getElementById("root")).render(t.jsx(r.StrictMode,{children:t.jsx(ee,{children:t.jsx(be,{children:t.jsx($e,{})})})}));
